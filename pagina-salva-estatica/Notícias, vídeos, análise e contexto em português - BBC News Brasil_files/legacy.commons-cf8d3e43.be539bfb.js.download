"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5340],{20813:function(e,t,i){var r=i(96540),n=i(29624),o=i(4146);function s(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var a=s(r),u=s(n),l=r.createContext({optimizely:null,isServerSide:!1,timeout:0}),c=l.Consumer,d=l.Provider,f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},f(e,t)};function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var v=function(){return v=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},v.apply(this,arguments)};function p(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function h(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(i=1,r&&(n=2&a[0]?r.return:a[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;switch(r=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}function y(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}function m(e,t){if(e.id!==t.id)return!1;var i=e.attributes||{},r=t.attributes||{},n=Object.keys(i),o=Object.keys(r);if(n.length!==o.length)return!1;for(var s=0,a=n;s<a.length;s++){var u=a[s];if(i[u]!==r[u])return!1}return!0}function U(e){return"object"==typeof e&&null!==e?e:{}}function g(e,t){var i=U(e),r=U(t),n=Object.keys(i),o=Object.keys(r);return n.length===o.length&&n.every((function(e){return e in r&&i[e]===r[e]}))}function O(e,t,i){return{enabled:!1,flagKey:e,ruleKey:null,variationKey:null,variables:{},reasons:[t],userContext:{id:i.id,attributes:i.attributes}}}function I(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var r=0;return e.replace(/%s/g,(function(){var e=t[r++],i=typeof e;return"function"===i?e():"string"===i?e:String(e)}))}"function"==typeof SuppressedError&&SuppressedError;var _,z=function(){function e(){this.observers=[]}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.subscribe=function(e,t){var i=this,r="key-".concat(Math.floor(1e5+999999*Math.random()));return this.observers.push({subscriptionId:r,key:e,callback:t}),function(){var e=i.observers.findIndex((function(e){return e.subscriptionId===r}));e>=0&&i.observers.splice(e,1)}},e.prototype.notify=function(e){this.observers.filter((function(t){return t.key===e})).forEach((function(e){return e.callback()}))},e}().getInstance(),E=u.getLogger("ReactSDK"),C=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return E.log(u.enums.LOG_LEVEL.WARNING,I.apply(void 0,y([e],t,!1)))},R=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return E.log(u.enums.LOG_LEVEL.INFO,I.apply(void 0,y([e],t,!1)))},x=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return E.log(u.enums.LOG_LEVEL.ERROR,I.apply(void 0,y([e],t,!1)))};!function(e){e.TIMEOUT="TIMEOUT",e.NO_CLIENT="NO_CLIENT",e.USER_NOT_READY="USER_NOT_READY"}(_||(_={}));var F={id:null,attributes:{}},S=function(){function e(e){var t=this;this.userContext=null,this.onUserUpdateHandlers=[],this.isUserPromiseResolved=!1,this.isUserReady=!1,this.onForcedVariationsUpdateHandlers=[],this.forcedDecisionFlagKeys=new Set,this.isClientReady=!1,this.clientAndUserReadyPromiseFulfilled=!1,this.isUsingSdkKey=!1,this.user=v({},F),this.initialConfig=e;var i=v(v({},e),{clientEngine:"react-sdk",clientVersion:"3.2.3"});this.userPromiseResolver=function(){};var r=new Promise((function(e){t.userPromiseResolver=e}));if(this._client=u.createInstance(i),this.isClientReady=!!this.getOptimizelyConfig(),this.isUsingSdkKey=!!i.sdkKey,this._client){var n=this._client.onReady();this.clientAndUserReadyPromise=Promise.all([r,n]).then((function(e){var i=e[0],r=e[1];t.isClientReady=r.success,t.isUserReady=i.success;var n=t.isReady();return t.clientAndUserReadyPromiseFulfilled=!0,{success:n,message:n?"Client and user are both ready.":"Client or user did not become ready."}}))}else C("Unable to resolve datafile and user information because Optimizely client failed to initialize."),this.clientAndUserReadyPromise=new Promise((function(e){e({success:!1,reason:_.NO_CLIENT,message:"Optimizely client failed to initialize."})}))}return e.prototype.getUserWithOverrides=function(e,t){return{id:void 0===e?this.user.id:e,attributes:void 0===t?this.user.attributes:t}},e.prototype.getIsReadyPromiseFulfilled=function(){return this.clientAndUserReadyPromiseFulfilled},e.prototype.getIsUsingSdkKey=function(){return this.isUsingSdkKey},Object.defineProperty(e.prototype,"odpExplicitlyOff",{get:function(){var e;return null===(e=this.initialConfig.odpOptions)||void 0===e?void 0:e.disabled},enumerable:!1,configurable:!0}),e.prototype.onReady=function(e){var t,i=this;void 0===e&&(e={});var r=5e3;e&&void 0!==e.timeout&&(r=e.timeout);var n=new Promise((function(e){t=setTimeout((function(){e({success:!1,reason:_.TIMEOUT,message:"Failed to initialize before timeout",dataReadyPromise:i.clientAndUserReadyPromise})}),r)}));return Promise.race([this.clientAndUserReadyPromise,n]).then((function(e){return p(i,void 0,void 0,(function(){return h(this,(function(i){return clearTimeout(t),[2,e]}))}))}))},e.prototype.getUserContext=function(){return this._client?this.userContext?this.userContext:(C("Unable to get user context. User context not set."),null):(C("Unable to get user context. Optimizely client not initialized."),null)},e.prototype.setCurrentUserContext=function(e){this._client?this.userContext&&m(e,{id:this.userContext.getUserId(),attributes:this.userContext.getAttributes()})||(this.userContext=this._client.createUserContext(e.id||void 0,e.attributes)):C("Unable to set user context for user ID ".concat(e.id,". Optimizely client not initialized."))},e.prototype.makeUserContextInstance=function(e){return this._client?this.userContext&&m(e,this.user)?this.userContext:this._client.createUserContext(e.id||void 0,e.attributes):(C("Unable to create user context for ".concat(e.id,". Optimizely client failed to initialize or not ready.")),null)},e.prototype.fetchQualifiedSegments=function(e){return p(this,void 0,void 0,(function(){var t;return h(this,(function(i){switch(i.label){case 0:return this.userContext?this.odpExplicitlyOff||!(null===(t=this._client)||void 0===t?void 0:t.isOdpIntegrated())?[2,!0]:[4,this.userContext.fetchQualifiedSegments(e)]:[2,!1];case 1:return[2,i.sent()]}}))}))},e.prototype.setUser=function(e){return p(this,void 0,void 0,(function(){var t,i,r,n,o=this;return h(this,(function(s){switch(s.label){case 0:return this.user={id:e.id||F.id,attributes:e.attributes||F.attributes},e.id!==F.id?[3,2]:[4,null===(i=this._client)||void 0===i?void 0:i.onReady()];case 1:return s.sent(),this.setCurrentUserContext(e),this.user.id=(null===(r=this.userContext)||void 0===r?void 0:r.getUserId())||F.id,[3,4];case 2:return this.setCurrentUserContext(e),[4,null===(n=this._client)||void 0===n?void 0:n.onReady()];case 3:s.sent(),s.label=4;case 4:return[4,this.fetchQualifiedSegments()];case 5:return t=s.sent(),this.isUserPromiseResolved||(this.userPromiseResolver({success:t}),this.isUserPromiseResolved=!0),this.onUserUpdateHandlers.forEach((function(e){return e(o.user)})),[2]}}))}))},e.prototype.onUserUpdate=function(e){var t=this;return this.onUserUpdateHandlers.push(e),function(){var i=t.onUserUpdateHandlers.indexOf(e);i>-1&&t.onUserUpdateHandlers.splice(i,1)}},e.prototype.onForcedVariationsUpdate=function(e){var t=this;return this.onForcedVariationsUpdateHandlers.push(e),function(){var i=t.onForcedVariationsUpdateHandlers.indexOf(e);i>-1&&t.onForcedVariationsUpdateHandlers.splice(i,1)}},e.prototype.isReady=function(){return this.isClientReady&&this.isUserReady},e.prototype.activate=function(e,t,i){if(!this._client)return C('Unable to activate experiment "%s" because Optimizely client failed to initialize.',e),null;var r=this.getUserWithOverrides(t,i);return null===r.id?(R('Unable to activate experiment "%s" because User ID is not set',e),null):this._client.activate(e,r.id,r.attributes)},e.prototype.decide=function(e,t,i,r){if(void 0===t&&(t=[]),!this._client)return C('Unable to evaluate feature "%s" because Optimizely client failed to initialize.',e),O(e,"Unable to evaluate flag ".concat(e," because Optimizely client failed to initialize."),this.user);var n=this.getUserWithOverrides(i,r);if(null===n.id)return R('Unable to evaluate feature "%s" because User ID is not set.',e),O(e,"Unable to evaluate flag ".concat(e," because User ID is not set."),n);var o=this.makeUserContextInstance(n);return o?v(v({},o.decide(e,t)),{userContext:{id:n.id,attributes:n.attributes}}):O(e,"Not Evaluating flag ".concat(e," because user id or attributes are not valid"),n)},e.prototype.decideForKeys=function(e,t,i,r){if(void 0===t&&(t=[]),!this._client)return C("Unable to evaluate features for keys because Optimizely client failed to initialize."),{};var n=this.getUserWithOverrides(i,r);if(null===n.id)return R("Unable to evaluate features for keys because User ID is not set"),{};var o=this.makeUserContextInstance(n);return o?Object.entries(o.decideForKeys(e,t)).reduce((function(e,t){var i=t[0],r=t[1];return e[i]=v(v({},r),{userContext:{id:n.id||"",attributes:n.attributes}}),e}),{}):{}},e.prototype.decideAll=function(e,t,i){if(void 0===e&&(e=[]),!this._client)return C("Unable to evaluate all feature decisions because Optimizely client is not initialized."),{};var r=this.getUserWithOverrides(t,i);if(null===r.id)return R("Unable to evaluate all feature decisions because User ID is not set"),{};var n=this.makeUserContextInstance(r);return n?Object.entries(n.decideAll(e)).reduce((function(e,t){var i=t[0],n=t[1];return e[i]=v(v({},n),{userContext:{id:r.id||"",attributes:r.attributes}}),e}),{}):{}},e.prototype.getVariation=function(e,t,i){if(!this._client)return C('Unable to get variation for experiment "%s" because Optimizely client failed to initialize.',e),null;var r=this.getUserWithOverrides(t,i);return null===r.id?(R('Unable to get variation for experiment "%s" because User ID is not set',e),null):this._client.getVariation(e,r.id,r.attributes)},e.prototype.track=function(e,t,i,r){if(this._client){void 0!==t&&"string"!=typeof t&&(r=t,t=void 0);var n=this.getUserWithOverrides(t,i);null!==n.id?this._client.track(e,n.id,n.attributes,r):R('Unable to send tracking event "%s" because User ID is not set',e)}else C('Unable to send tracking event "%s" because Optimizely client failed to initialize.',e)},e.prototype.setForcedDecision=function(e,t){this.userContext?this.userContext.setForcedDecision(e,t)&&(this.forcedDecisionFlagKeys.add(e.flagKey),z.notify(e.flagKey)):C("Unable to set a forced decision because the user context has not been set yet.")},e.prototype.getForcedDecision=function(e){return this.userContext?this.userContext.getForcedDecision(e):(C("Unable to get a forced decision because the user context has not been set yet."),null)},e.prototype.removeForcedDecision=function(e){if(!this.userContext)return C("Unable to remove forced decisions because the user context has not been set yet."),!1;var t=this.userContext.removeForcedDecision(e);return t&&(this.forcedDecisionFlagKeys.delete(e.flagKey),z.notify(e.flagKey)),t},e.prototype.removeAllForcedDecisions=function(){if(!this.userContext)return C("Unable to remove all forced decisions because the user context has not been set yet."),!1;var e=this.userContext.removeAllForcedDecisions();return e&&(this.forcedDecisionFlagKeys.forEach((function(e){return z.notify(e)})),this.forcedDecisionFlagKeys.clear()),e},e.prototype.isFeatureEnabled=function(e,t,i){if(!this._client)return C('Unable to determine if feature "%s" is enabled because Optimizely client failed to initialize.',e),!1;var r=this.getUserWithOverrides(t,i);return null===r.id?(R('Unable to determine if feature "%s" is enabled because User ID is not set',e),!1):this._client.isFeatureEnabled(e,r.id,r.attributes)},e.prototype.getFeatureVariables=function(e,t,i){var r=this;if(!this._client)return C('Unable to get feature variables for feature "%s" because Optimizely client failed to initialize.',e),{};var n=this.getUserWithOverrides(t,i),o=n.id;if(null===o)return C('Unable to get feature variables for feature "%s" because User ID is not set',e),{};var s=n.attributes,a={},u=this._client.getOptimizelyConfig();if(!u)return C('Unable to retrieve feature variables for feature "%s" because Optimizely client failed to initialize.',e),{};var l=u.featuresMap[e];return l?(Object.keys(l.variablesMap).forEach((function(t){var i=l.variablesMap[t];a[i.key]=r._client.getFeatureVariable(e,i.key,o,s)})),a):(R('Unable to retrieve feature variables for feature "%s" because config features map is not set',e),{})},e.prototype.getFeatureVariableString=function(e,t,i,r){if(!this._client)return C('Unable to get feature variable string from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R('Unable to get feature variable string from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableString(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableBoolean=function(e,t,i,r){if(!this._client)return C('Unable to get feature variable boolean from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R('Unable to get feature variable boolean from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableBoolean(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableInteger=function(e,t,i,r){if(!this._client)return C('Unable to get feature variable integer from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R('Unable to get feature variable integer from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableInteger(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableDouble=function(e,t,i,r){if(!this._client)return C('Unable to get feature variable double from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R('Unable to get feature variable double from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableDouble(e,t,n.id,n.attributes)},e.prototype.getFeatureVariableJSON=function(e,t,i,r){if(!this._client)return C('Unable to get feature variable JSON from feature "%s" because Optimizely client failed to initialize.',e),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R('Unable to get feature variable JSON from feature "%s" because User ID is not set',e),null):this._client.getFeatureVariableJSON(e,t,n.id,n.attributes)},e.prototype.getFeatureVariable=function(e,t,i,r){if(!this._client)return C('Unable to get feature variable from feature "%s" because Optimizely client failed to initialize.',e,t),null;var n=this.getUserWithOverrides(i,r);return null===n.id?(R('Unable to get feature variable from feature "%s" because User ID is not set',e,t),null):this._client.getFeatureVariable(e,t,n.id,n.attributes)},e.prototype.getAllFeatureVariables=function(e,t,i){if(!this._client)return C('Unable to get all feature variables from feature "%s" because Optimizely client failed to initialize.',e),{};var r=this.getUserWithOverrides(t,i);return null===r.id?(R('Unable to get all feature variables from feature "%s" because User ID is not set',e),{}):this._client.getAllFeatureVariables(e,r.id,r.attributes)},e.prototype.getEnabledFeatures=function(e,t){if(!this._client)return C("Unable to get list of enabled features because Optimizely client failed to initialize."),[];var i=this.getUserWithOverrides(e,t);return null===i.id?(R("Unable to get list of enabled features because User ID is not set"),[]):this._client.getEnabledFeatures(i.id,i.attributes)},e.prototype.getForcedVariation=function(e,t){if(!this._client)return C('Unable to get forced variation for experiment "%s" because Optimizely client failed to initialize.',e),null;var i=this.getUserWithOverrides(t);return null===i.id?(R('Unable to get forced variation for experiment "%s" because User ID is not set',e),null):this._client.getForcedVariation(e,i.id)},e.prototype.setForcedVariation=function(e,t,i){if(!this._client)return C('Unable to set forced variation for experiment "%s" because Optimizely client failed to initialize.',e),!1;var r=null,n=null;if(2===arguments.length)n=t,r=this.getUserWithOverrides().id;else if(3===arguments.length){if(r=this.getUserWithOverrides(t).id,void 0===i)return!1;n=i}if(null===r)return C('Unable to set forced variation for experiment "%s" because User ID is not set',e),!1;var o=this._client.setForcedVariation(e,r,n);return this.onForcedVariationsUpdateHandlers.forEach((function(e){return e()})),o},e.prototype.getOptimizelyConfig=function(){return this._client?this._client.getOptimizelyConfig():(C("Unable to get Optimizely configuration because Optimizely client failed to initialize."),null)},e.prototype.close=function(){return this._client?this._client.close():new Promise((function(e,t){return e({success:!0,reason:"Optimizely client is not initialized."})}))},Object.defineProperty(e.prototype,"client",{get:function(){return this._client?this._client:(C("Unable to get client because Optimizely client failed to initialize."),null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"notificationCenter",{get:function(){return this._client?this._client.notificationCenter:{addNotificationListener:function(){return C("Unable to add notification listener because Optimizely client failed to initialize."),0},removeNotificationListener:function(){return C("Unable to remove notification listener because Optimizely client failed to initialize."),!1},clearAllNotificationListeners:function(){C("Unable to clear all notification listeners because Optimizely client failed to initialize.")},clearNotificationListeners:function(){C("Unable to clear notification listeners because Optimizely client failed to initialize.")}}},enumerable:!1,configurable:!0}),e.prototype.sendOdpEvent=function(e,t,i,r){var n;e&&e.trim()?null===(n=this.client)||void 0===n||n.sendOdpEvent(e,t,i,r):x("ODP action is not valid (cannot be empty).")},e.prototype.getVuid=function(){if(this._client)return this._client.getVuid();C("Unable to get VUID because Optimizely client failed to initialize.")},e}();var D,A=n.getLogger("<OptimizelyProvider>"),P=function(e){function t(t){var i=e.call(this,t)||this;return i.setUserInOptimizely(),i}return b(t,e),t.prototype.setUserInOptimizely=function(){return p(this,void 0,void 0,(function(){var e,t,i,r,n,o,s,a,u;return h(this,(function(l){switch(l.label){case 0:if(e=this.props,t=e.optimizely,i=e.userId,r=e.userAttributes,n=e.user,!t)return A.error("OptimizelyProvider must be passed an instance of the Optimizely SDK client"),[2];if(o=null,n?"then"in n?n.then((function(e){t.setUser(e)})):o={id:n.id,attributes:n.attributes||{}}:i?(o={id:i,attributes:r||{}},A.warn("Passing userId and userAttributes as props is deprecated, please switch to using `user` prop")):t.user?(s=t.user,a=s.id,u=s.attributes,o={id:a,attributes:r||u||{}}):o={id:F.id,attributes:r||F.attributes},!o)return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,t.setUser(o)];case 2:return l.sent(),[3,4];case 3:return l.sent(),A.error("Error while trying to set user."),[3,4];case 4:return[2]}}))}))},t.prototype.componentDidUpdate=function(e){if(!e.isServerSide){var t=this.props.optimizely;this.props.user&&"id"in this.props.user&&(t.user.id&&m({id:t.user.id,attributes:t.user.attributes||{}},{id:this.props.user.id,attributes:this.props.user.attributes||{}})||t.setUser(this.props.user))}},t.prototype.render=function(){var e=this.props,t=e.optimizely,i=e.children,r=e.timeout,n={optimizely:t,isServerSide:!!this.props.isServerSide,timeout:r};return a.createElement(d,{value:n},i)},t}(a.Component),T=function(e,t,i,r,o){var s="re-evaluating ".concat(t,'="').concat(i,'" for user="').concat(e.user.id,'"'),a=e.notificationCenter.addNotificationListener(n.enums.NOTIFICATION_TYPES.OPTIMIZELY_CONFIG_UPDATE,(function(){r.info("".concat(n.enums.NOTIFICATION_TYPES.OPTIMIZELY_CONFIG_UPDATE,", ").concat(s)),o()})),u=e.onUserUpdate((function(){r.info("User update, ".concat(s)),o()}));return function(){e.notificationCenter.removeNotificationListener(a),u()}},k=n.getLogger("ReactSDK"),w="The 'optimizely' prop must be supplied via a parent <OptimizelyProvider>";function V(e,t){return e.entityKey===t.entityKey&&e.overrideUserId===t.overrideUserId&&g(e.overrideAttributes,t.overrideAttributes)}function N(e,t,i){e.onReady({timeout:t}).then((function(e){var r,n,o,s;if(e.success)return k.info("Client immediately ready"),void i({clientReady:!0,didTimeout:!1});switch(e.reason){case _.NO_CLIENT:k.warn('Client not ready, reason="'.concat(e.message,'"')),i({clientReady:!1,didTimeout:!1}),null===(r=e.dataReadyPromise)||void 0===r||r.then((function(e){if(e){var t=e.success,r=e.message;t?k.info("Client became ready."):k.warn('Client not ready, reason="'.concat(r,'"')),i({clientReady:t,didTimeout:!1})}}));break;case _.USER_NOT_READY:k.warn('User was not ready, reason="'.concat(e.message,'"')),i({clientReady:!1,didTimeout:!1}),null===(n=e.dataReadyPromise)||void 0===n||n.then((function(e){if(e){var t=e.success,r=e.message;t?k.info("User became ready later."):k.warn('Client not ready, reason="'.concat(r,'"')),i({clientReady:t,didTimeout:!1})}}));break;case _.TIMEOUT:k.info("Client did not become ready before timeout of ".concat(t,' ms, reason="').concat(e.message,'"')),i({clientReady:!1,didTimeout:!0}),null===(o=e.dataReadyPromise)||void 0===o||o.then((function(e){if(e){var t=e.success,r=e.message;t?k.info("Client became ready after timeout already elapsed"):k.warn('Client not ready, reason="'.concat(r,'"')),i({clientReady:t,didTimeout:!0})}}));break;default:k.warn('Other reason client not ready, reason="'.concat(e.message,'"')),i({clientReady:!1,didTimeout:!1}),null===(s=e.dataReadyPromise)||void 0===s||s.then((function(e){if(e){var t=e.success,r=e.message;t?k.info("Client became ready later"):k.warn('Client not ready, reason="'.concat(r,'"')),i({clientReady:t,didTimeout:!1})}}))}})).catch((function(){k.error("Error initializing client. The core client or user promise(s) rejected.")}))}function K(e){var t=r.useRef();return g(e,t.current)||(t.current=e),t.current}!function(e){e.EXPERIMENT="Experiment",e.FEATURE="Feature"}(D||(D={}));var L=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={});var n=r.useContext(l),o=n.optimizely,s=n.isServerSide,a=n.timeout,u=K(i.overrideAttributes),c=r.useCallback((function(){return{variation:(null==o?void 0:o.activate(e,i.overrideUserId,u))||null}}),[o,e,i.overrideUserId,u]),d=s||!!(null==o?void 0:o.isReady()),f=!!(null==o?void 0:o.getIsReadyPromiseFulfilled()),b=r.useState((function(){var e=d?c():{variation:null};return v(v({},e),{clientReady:d,didTimeout:!1})})),p=b[0],h=b[1],y={entityKey:e,overrideUserId:i.overrideUserId,overrideAttributes:u},m=r.useState(y),U=m[0],g=m[1];V(U,y)||(g(y),h((function(e){return v(v({},e),c())})));var O=void 0!==t.timeout?t.timeout:a;return r.useEffect((function(){o&&(o.getIsUsingSdkKey()&&!f||!d)&&N(o,O,(function(e){h(v(v({},c()),e))}))}),[O,c,d,f,o]),r.useEffect((function(){return o&&f&&t.autoUpdate?T(o,D.EXPERIMENT,e,k,(function(){h((function(e){return v(v({},e),c())}))})):function(){}}),[f,t.autoUpdate,o,e,c]),r.useEffect((function(){return null==o?void 0:o.onForcedVariationsUpdate((function(){h((function(e){return v(v({},e),c())}))}))}),[c,o]),o||k.error("Unable to use experiment ".concat(e,". ").concat(w)),[p.variation,p.clientReady,p.didTimeout]},j=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={});var n=r.useContext(l),o=n.optimizely,s=n.isServerSide,a=n.timeout,u=K(i.overrideAttributes),c=r.useCallback((function(){return{isEnabled:!!(null==o?void 0:o.isFeatureEnabled(e,i.overrideUserId,u)),variables:(null==o?void 0:o.getFeatureVariables(e,i.overrideUserId,u))||{}}}),[o,e,i.overrideUserId,u]),d=s||!!(null==o?void 0:o.isReady()),f=!!(null==o?void 0:o.getIsReadyPromiseFulfilled()),b=r.useState((function(){var e=d?c():{isEnabled:!1,variables:{}};return v(v({},e),{clientReady:d,didTimeout:!1})})),p=b[0],h=b[1],y={entityKey:e,overrideUserId:i.overrideUserId,overrideAttributes:i.overrideAttributes},m=r.useState(y),U=m[0],g=m[1];V(U,y)||(g(y),h((function(e){return v(v({},e),c())})));var O=void 0!==t.timeout?t.timeout:a;return r.useEffect((function(){!o||!o.getIsUsingSdkKey()&&d||N(o,O,(function(e){h(v(v({},c()),e))}))}),[O,c,o]),r.useEffect((function(){return o&&f&&t.autoUpdate?T(o,D.FEATURE,e,k,(function(){h((function(e){return v(v({},e),c())}))})):function(){}}),[f,t.autoUpdate,o,e,c]),o||k.error("Unable to properly use feature ".concat(e,". ").concat(w)),[p.isEnabled,p.variables,p.clientReady,p.didTimeout]},W=function(e){var t=e.feature,i=e.timeout,r=e.autoUpdate,n=e.children,o=e.overrideUserId,s=e.overrideAttributes,u=j(t,{timeout:i,autoUpdate:r},{overrideUserId:o,overrideAttributes:s}),l=u[0],c=u[1],d=u[2],f=u[3];return d||f?a.createElement(a.Fragment,null,n(l,c,d,f)):null};var M=function(e){var t=e.experiment,i=e.autoUpdate,r=e.timeout,n=e.overrideUserId,o=e.overrideAttributes,s=e.children,u=L(t,{timeout:r,autoUpdate:i},{overrideUserId:n,overrideAttributes:o}),l=u[0],c=u[1],d=u[2];if(!c&&!d)return null;if(null!=s&&"function"==typeof s)return a.createElement(a.Fragment,null,s(l,c,d));var f=null,b=null;a.Children.forEach(s,(function(e){a.isValidElement(e)&&(e.props.variation&&l===e.props.variation&&(b=e),e.props.default&&(f=e))}));var v=null;return b?v=b:f&&(v=f),v},H=function(e){var t=e.children;return a.createElement(a.Fragment,null,t)},Y=u.getLogger("ReactSDK"),G={dispatchEvent:function(e,t){Y.debug("Event not dispatched by disabled event dispatcher: %s",(function(){var t;try{t=JSON.stringify(e)}catch(e){t="error stringifying event"}return t})),t({statusCode:204})}};Object.defineProperty(t,"Br",{enumerable:!0,get:function(){return n.setLogger}}),t.wP=l,t.WY=P,t.Q_=function(e){return new S(e)},t.A2=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={});var n=r.useContext(l),o=n.optimizely,s=n.isServerSide,a=n.timeout,u=K(i.overrideAttributes),c=r.useMemo((function(){return O(e,"Optimizely SDK not configured properly yet.",{id:i.overrideUserId||null,attributes:u||{}})}),[e,u,i.overrideUserId]),d=r.useCallback((function(){return{decision:(null==o?void 0:o.decide(e,t.decideOptions,i.overrideUserId,u))||c}}),[e,c,o,t.decideOptions,u,i.overrideUserId]),f=s||!!(null==o?void 0:o.isReady()),b=!!(null==o?void 0:o.getIsReadyPromiseFulfilled()),p=r.useState((function(){var e=f?d():{decision:c};return v(v({},e),{clientReady:f,didTimeout:!1})})),h=p[0],y=p[1],m={entityKey:e,overrideUserId:i.overrideUserId,overrideAttributes:i.overrideAttributes},U=r.useState(m),g=U[0],I=U[1];V(g,m)||(I(m),y((function(e){return v(v({},e),d())})));var _=void 0!==t.timeout?t.timeout:a;return r.useEffect((function(){!o||!o.getIsUsingSdkKey()&&f||N(o,_,(function(e){y(v(v({},d()),e))}))}),[_,d,o]),r.useEffect((function(){if(!i.overrideUserId&&!i.overrideAttributes&&t.autoUpdate)return z.subscribe(e,(function(){y((function(e){return v(v({},e),d())}))}))}),[i.overrideUserId,i.overrideAttributes,t.autoUpdate,e,d]),r.useEffect((function(){return o&&b&&t.autoUpdate?T(o,D.FEATURE,e,k,(function(){y((function(e){return v(v({},e),d())}))})):function(){}}),[b,t.autoUpdate,o,e,d]),o||k.error("Unable to use decision ".concat(e,". ").concat(w)),[h.decision,h.clientReady,h.didTimeout]}}}]);
//# sourceMappingURL=legacy.commons-cf8d3e43.be539bfb.js.map